<% provide(:title, @user.full_name) %>
<div class="container">
  <p id="notice"><%= notice %></p>

<script src="js/navbarVolunteer.js"></script>
<br>
<div class="container target">
  <div class="row">
    <div class="col-sm-8">
      <h1 class="pull-left"> &nbsp <%= @user.full_name %> </h1>
      <div class="row">
      <div class="col-sm-10">  
        <% if @user != current_user %> 
          <% if @rel_user_followed_by_current_user %> 
            <%= link_to "Remove from Favorites", "#", class: "btn btn-success col-sm-4 remove-favorite", "follower-id" => current_user.uuid, "following-id" => @user.uuid %>
          <% else %>
            <%= link_to "Add to Favorites", "#", class: "btn btn-primary col-sm-4 add-favorite", "follower-id" => current_user.uuid, "following-id" => @user.uuid %>
          <% end %>
          <div class="col-sm-1"></div>
          <%= link_to "Open Chat", "#", class: "btn btn-info col-sm-4 start-conversation",
                    "data-sid" => current_user.uuid, "data-rip" => @user.uuid %>
        <% else %>  
          <%= link_to "Find My Match", mymatches_path, class: "btn btn-success col-sm-3" %>
          <div class="col-sm-1"></div>
          <%= link_to 'Write New Post', new_blog_path, class: "btn btn-info col-sm-3" %>  
          <%= link_to 'Edit', edit_user_path(@user) %>   
        <% end %>
      </div>
      </div>
      <br>
    </div>
      <% if @user.avatar? %>
        <a class="pull-right"><img title="profile image" class="img-circle img-responsive" <%= image_tag @user.avatar.thumb.url %> </a> 
      <% else %>
          <a class="pull-right"><img title="profile image" class="img-circle img-responsive" <%= gravatar_for @user %> </a>
      <% end %>
    </div>
  </div>

  <br>

  <div class="row">
    <div class="col-sm-3">
    <!--left col-->
      <ul class="list-group">
        <li class="list-group-item text-muted" contenteditable="false">Profile</li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Last seen</strong></span>
          <% if @user.last_seen_at %>
            <%= time_ago_in_words(@user.last_seen_at) + " ago" %>  
          <% else %>
            N/A
          <% end %>
        </li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Joined</strong></span><%= @user.created_at.to_time.strftime('%B %e, %Y') %></li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Location</strong></span> <%= @user_country_of_residence.name %> </li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Birthday</strong></span> <%= @user.date_of_birth.to_time.strftime('%B %e, %Y') %>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Gender</strong></span> <%= @user.gender %> 
      </ul>

      
      <div class="panel panel-default">
        <div class="panel-heading">Available to travel</div>
          <div class="panel-body">
            <% if @trips.any? %>
              <% @trips.each do |trip| %>
                <i style="color:green" class="fa fa-check-square"></i>  <%= trip.date_from.to_time.strftime('%b %e, %Y') %> - <%= trip.date_to.to_time.strftime('%b %e, %Y') %>
                <br>
              <% end %>
            <% else %>
              
                N/A
              
            <% end %>
          </div>
      </div>
      


      <ul class="list-group">
        <li class="list-group-item text-muted">Statistics <i class="fa fa-dashboard fa-1x"></i></li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Recommendations</strong></span> 175</li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Connections</strong></span> 500</li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Trips</strong></span> <%= @trips.count %></li>
        <li class="list-group-item text-right"><span class="pull-left"><strong class="">Followers</strong></span> 250</li>
      </ul>    
    </div>
    <!--/col-3-->

    <div class="col-sm-9" style="" contenteditable="false">
      

      <div class="panel panel-default">
        <div class="panel-heading">Blog</div>
        <div class="panel-body"> 
          <% if @user == current_user %>
            <%= render 'blogs/form' %>
          <% end %>
          <%= render @user_blog %>
          <small><%= will_paginate @user_blog %></small>
        </div>
      </div>

      <div class="panel panel-default" >
        <div class="panel-heading">About</div>
        <div class="panel-body"> 
          <table class="table">

            <strong> <%= @user.about_me %> </strong>
            <br>
            <br>
            <tr>
              <th>I visited: </th>
              <td>
                <% @hasBeenTo.each do |country| %>
                  <%= country.name %>
                <% end %>
              </td>
            </tr>
            <tr>
              <th>I want to visit: </th>
              <td>
                <% @wantsToGoTo.each do |country| %>
                  <%= country.name %>
                <% end %>
              </td>
            </tr>
          </table>
        </div>
      </div>        

      <div class="panel panel-default target">
        <div class="panel-heading" contenteditable="false">Trips</div>
          <div class="panel-body">
            <div class="row">

              <% if @trips.any? %>
                <% @trips.each do |trip| %>
                <div class="col-md-4">
                  <div class="thumbnail" alt="300x200">
                    <% if trip.photo? %>
                      <%= link_to image_tag(trip.photo.medium.url), trip %>
                    <% end %>
                    <div class="caption">
                      <h4><%= link_to trip.country, trip %></h4>
                      <h5><%= trip.place %></h5>
                      <p><i><%= trip.date_from.to_time.strftime('%b %e, %Y') %> - <%= trip.date_to.to_time.strftime('%b %e, %Y') %></i></p>
                    </div>
                    <div class="meta">
                      <%= time_ago_in_words(trip.updated_at) + " ago"%>
                      <% if current_user.admin? || @user == current_user %>
                        | <%= link_to 'Edit', edit_trip_path(trip) %>
                        | <%= link_to 'Delete', trip, method: :delete, data: { confirm: 'Are you sure you want to delete this trip?' } %>
                      <% end %>
                    </div>
                  </div>
                </div>
                <% end %>
              <% else %>
                <div class="container">
                <% if @user == current_user %>
                  <%= link_to 'Plan a trip now!', newtrip_path %>
                <% else %>
                  User has not planned any trip.
                <%end %>
                </div>
              <% end %>

            </div>           
          </div>             
        </div>
      </div>
    <div id="push"></div>
  </div>

  <div class="panel panel-default target">
    <div class="panel-heading" contenteditable="false">My default TravelMatch</div>
    <div class="panel-body">
      <div class="row">
        <div class="container">
          <div class="col-sm-11">
            <ul class="users">
              <%= render @user_matches %>
            </ul>
            <small><%= will_paginate @user_matches %></small>
          </div>
        </div>
      </div>         
    </div> 
  </div>
        

  <p>
    <strong>Password hash:</strong>
    <%= @user.password_hash %>
  </p>

  <p>
    <strong>Remember hash:</strong>
    <%= @user.remember_hash %>
  </p>

</div>